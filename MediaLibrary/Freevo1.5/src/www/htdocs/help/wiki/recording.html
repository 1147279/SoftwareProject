<html><head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=iso-8859-1">
<title>RecordingInfo - Freevo Wiki</title>
<meta name="KEYWORDS" content="Recording, Info">
<link rel="stylesheet" type="text/css" href="/wiki/css/freevowiki.css">
<link rel="Start" href="FrontPage">
<link rel="Alternate" media="print" title="Print" href="RecordingInfo?action=print">
<link rel="Index" href="TitleIndex">
<link rel="Glossary" href="WordIndex">
<link rel="Help" href="HelpOnFormatting">
</head>
<body onload="window.defaultStatus='Freevo Wiki'"><a name="top"></a>
<table width="100%"><tr><td>
<a href="/cgi-bin/moin.cgi/FrontPage"></td></tr></table></a> <div id="titlebar"></div> <table><tr><td></a>
</td><td width="99%" valign="middle" class="headline"><font size="+3">&nbsp;<b>
<a title="Click here to do a full-text search for this title" href="/cgi-bin/moin.cgi/RecordingInfo?action=fullsearch&value=RecordingInfo&literal=1&case=1">RecordingInfo</a>
</b></font></td>
<td valign="bottom" align="left" nowrap>
<font face="Verdana" size="1"><a href="/cgi-bin/moin.cgi/UserPreferences">UserPreferences</a><br>&nbsp;</font>
</td></tr></table>

<a href="/cgi-bin/moin.cgi/HelpContents"><img src="/wiki/img/moin-help.gif" width="12" height="11" border="0" hspace="2" align="right" alt="HelpContents"></a>
<a href="/cgi-bin/moin.cgi/FindPage?value=RecordingInfo"><img src="/wiki/img/moin-search.gif" width="12" height="12" border="0" hspace="2" align="right" alt="Search"></a>
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=diff"><img src="/wiki/img/moin-diff.gif" width="15" height="11" border="0" hspace="2" align="right" alt="Diffs"></a>
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=info"><img src="/wiki/img/moin-info.gif" width="12" height="11" border="0" hspace="2" align="right" alt="Info"></a>
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=edit"><img src="/wiki/img/moin-edit.gif" width="12" height="12" border="0" hspace="2" align="right" alt="Edit"></a>
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=subscribe"><img src="/wiki/img/moin-email-x.gif" width="14" height="10" border="0" hspace="2" vspace="1" align="right" alt="Subscribe"></a>
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=format&mimetype=text/xml"><img src="/wiki/img/moin-xml.gif" width="20" height="13" border="0" hspace="2" align="right" alt="XML"></a>
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=print"><img src="/wiki/img/moin-print.gif" width="16" height="14" border="0" hspace="2" align="right" alt="Print"></a>
<a href="/cgi-bin/moin.cgi/RecordingInfo"><img src="/wiki/img/moin-show.gif" width="12" height="13" border="0" hspace="2" align="right" alt="View"></a>

<table class="navibar" cellpadding=0 cellspacing=3 border=0><tr><td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<b>Freevo Wiki</b>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/cgi-bin/moin.cgi/FrontPage">FrontPage</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/cgi-bin/moin.cgi/RecentChanges">RecentChanges</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/cgi-bin/moin.cgi/TitleIndex">TitleIndex</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/cgi-bin/moin.cgi/WordIndex">WordIndex</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/cgi-bin/moin.cgi/SiteNavigation">SiteNavigation</a>&nbsp;</font></td>
<td class="navibar" valign=top align=center bgcolor="#E8E8E8"><font class="navibar" face="Arial,Helvetica" size="-1">&nbsp;<a class="navibar" href="/cgi-bin/moin.cgi/HelpContents">HelpContents</a>&nbsp;</font></td>
</tr></table>
<hr>

<p><a name="head-b4e6a310890f62289340d7802703b8c2586c6d86"></a><H1>1 Intro</H1>

<p>There are three different types of Freevo Recording. Tv Line In, Btaudio and ivtv. The first two depend on using the bttv module for your tv card. The third is for use only with the ivtv module for the wintv PVR type cards. 
<p><a name="head-37b061ee92fe5a0b06b1265053dddc992f041f83"></a><H1>2 Btaudio</H1>

<p>This process using the sound from btaudio kernel module and the pictures from your bttv module. This is the preffered freevo setup for recording and the default settings in VCR_CMD reflect this. 
<p>This setup is problematic though since not all cards support btaudio and some cards only thought to work in certain configurations. Btaudio setup is its own topic and help can be found <a class="external" href="http://freevo.sourceforge.net/cgi-bin/moin.cgi/FrequentlyAskedQuestions#head-3fb8a33780b7fb2bef3edff84757d03e96461031"><img src="/wiki/img/moin-www.gif" width="11" border="0" alt="[WWW]" hspace="4" height="11">here</a>. 
<p>Once you have that setup you can change the default VCR_CMD's adevice to point to it. 
<p>This is also the best setup for doing timeshifting, thus it is reccomended to really try hard to get this setup to work for you. 
<p><a name="head-0d43655debb406649541dc468fa2b398afa56ebf"></a><H1>3 TV Line In</H1>

<p><a name="head-cb329146a0dd0d566b0628744d67936558741ffa"></a><H2>3.1 description</H2>

<p>This process using the line out sound from your tv card into the line in of your sound card for the sound and bttv for your pictures. This is a common bttv setup. 
<p>It has a couple inherit problems. First you will hear the program in the background when you are recording. And Second, You cannot run any apps that use the soundcard while recording(which pretty rules out everything except images and maybe running some scripts in commands plugin). 
<p>Another problem is that depending on your sound system you have to do different things to setup the recording. 
<p>VIA USERS: Note that if you have a VIA-based on-board sound card, you should uninstall the current drivers in your system and install the appropriate drivers found at <a href="http://www.viaarena.com">http://www.viaarena.com</a> . Then increase your IGain setting on your audio mixer to something greater than zero (ie: # aumix -l 0 -l R -i 35). 
<p><a name="head-c3afdb16d5c7850cfcfd6ed7e8ce2b00e6464826"></a><H2>3.2 OSS instructions</H2>

<p>Typically you need to use something like the following to mute and unmute the audio: 
<p><pre class="code">
# to unmute the audio 
aumix -l 80 -l R 
 
# to mute the audio 
aumix -l 0 
</pre> 
<p>Unfortuneately some Sound Blaster cards also need another variable tweaked when used with OSS. The soundblasters cards need and extra parameter (IGAIN) added to the aumix calls. for example: 
<p><pre class="code">
# to unmute the audio 
aumix -l 80 -l R -i 1 
 
# to mute the audio 
aumix -l 0 -i 0 
</pre> 
<p>Another variable that needs to change in the VCR_CMD is the adevice to /dev/dsp. You can do this by changing your VCR_CMD to a script setup similar to one <a class="external" href="http://cvs.sourceforge.net/viewcvs.py/freevo/freevo/contrib/record_without_btaudio/"><img src="/wiki/img/moin-www.gif" width="11" border="0" alt="[WWW]" hspace="4" height="11">here</a>. (One good thing about controling recording from a script is that it makes it easy to experiment from the command line.) Or to change the VCR_CMD to include a 'soundonscript ;' + at thefront of the command and a '; soundoffscript' at the end. 
<p><pre class="code">
#example for an older pre tv:// syntax mencoder 
VCR_CMD = ( 'aumix -l 80 -l R; '+ 
            CONF.mencoder + ' ' + 
            '-tv on:driver=v4l:input=0' +   # Input 0 = TV, Input 1 = Comp. V. in 
            ':norm=%s' % CONF.tv + 
            ':channel=%(channel)s' +         # Filled in by Freevo 
            ':chanlist=us-cable' +          # Change 
            ':width=%d:height=%d' % (TV_REC_SIZE[0], TV_REC_SIZE[1]) + 
            ':outfmt=%s' % TV_REC_OUTFMT + 
            ':device=%s' % TV_DEVICE + 
            ':adevice=/dev/dsp' +            
            ':audiorate=32000' +            # 44100 for better sound 
            ':forceaudio:forcechan=1:' +    # Forced mono for bug in my driver 
            'buffersize=64' +               # 64 Megabyte capture buffer, change? 
            ' -ovc lavc -lavcopts ' +       # Mencoder lavcodec video codec 
            'vcodec=mpeg4' +                # lavcodec mpeg-4 
            ':vbitrate=1200:' +             # Change lower/higher, bitrate 
            'keyint=30 ' +                  # Keyframe every 10 secs, change? 
            '-oac mp3lame -lameopts ' +     # Use Lame for MP3 encoding 
            'br=128:cbr:mode=3 ' +          # MP3 const. bitrate, 128 kbit/s 
            '-ffourcc divx ' +              # Force 'divx' ident, better compat. 
            '-endpos %(seconds)s ' +        # only mencoder uses this so do it here. 
            '-o %(filename)s.avi ' +        # Filled in by Freevo 
            '; aumix -l 0;') 
 
# example of newer tv:// syntax mencoder 
VCR_CMD = ( 'aumix -l 80 -l R; '+ 
            CONF.mencoder + ' ' + 
            'tv:// ' +                      # New mplayer requires this. 
            '-tv driver=v4l:input=0' +      # Input 0 = TV, Input 1 = Comp. V. in 
            ':norm=%s' % CONF.tv + 
            ':channel=%(channel)s' +        # Filled in by Freevo 
            ':chanlist=us-cable' +          # Change 
            ':width=%d:height=%d' % (TV_REC_SIZE[0], TV_REC_SIZE[1]) + 
            ':outfmt=%s' % TV_REC_OUTFMT + 
            ':device=%s' % TV_DEVICE + 
            ':adevice=/dev/dsp' +            
            ':audiorate=32000' +            # 44100 for better sound 
            ':forceaudio:forcechan=1:' +    # Forced mono for bug in my driver 
            'buffersize=64' +               # 64 Megabyte capture buffer, change? 
            ' -ovc lavc -lavcopts ' +       # Mencoder lavcodec video codec 
            'vcodec=mpeg4' +                # lavcodec mpeg-4 
            ':vbitrate=1200:' +             # Change lower/higher, bitrate 
            'keyint=30 ' +                  # Keyframe every 10 secs, change? 
            '-oac mp3lame -lameopts ' +     # Use Lame for MP3 encoding 
            'br=128:cbr:mode=3 ' +          # MP3 const. bitrate, 128 kbit/s 
            '-ffourcc divx ' +              # Force 'divx' ident, better compat. 
            '-endpos %(seconds)s ' +        # only mencoder uses this so do it here. 
            '-o %(filename)s.avi ' +        # Filled in by Freevo 
            '; aumix -l 0;') 
</pre> 
<p><a name="head-8f216ba94758334c0e7a7389c58e41e54718d3f7"></a><H2>3.3 ALSA</H2>

<p>This Alsa example is from the freevo users list. you may need to use this script in place of the VCR_CMD. The script itself has the line to change for VCR_CMD in it: 
<p><pre class="code">
#!/bin/bash 
  
# use with this VCR_CMD: 
# VCR_CMD = ('/usr/local/freevo_data/tvrecord/tvrecord %(channel)s %(seconds)s "%(filename)s"') 
  
CHAN=$1 
TIME=$2 
NAME=$3 
  
WIDTH=360 
HEIGHT=288 
  
MENCODER=/usr/bin/mencoder 
AMIXER=/usr/bin/amixer 
  
NICE="nice -n -20" 
  
AUDIO="-oac mp3lame -lameopts cbr:br=256:mode=0" 
VIDEO="-ovc lavc -lavcopts vcodec=mpeg4:vbitrate=1600" 
DSP="adevice=/dev/sound/dsp" 
TV=" -tv driver=v4l:width=$WIDTH:height=$HEIGHT:outfmt=yuy2:input=0:device=/dev/v4l/video0:norm=PAL:chanlist=europe-west:channel=$CHAN:$DSP" 
  
$AMIXER -q sset CD 87% mute 
$AMIXER -q sset Capture 87% 
$AMIXER -q cset numid=30 1      # select capture source, 30 is capture source control, 1 = CD and 4 = line 
$AMIXER -q cset numid=31 1      # set capture source switch to 1 (= on) 
$NICE $MENCODER tv:// $TV $VIDEO $AUDIO -endpos $TIME -ffourcc divx -o  "$NAME.avi" 
$AMIXER -q sset CD 87% unmute   # unmute cd again to hear sound when using watching tv after recording 
</pre> 
<p>Some things to note: <ul>
<li> The source provided here is CD IN. 
</li><li> The norm is PAL. 
</li><li> chanlist is europe-west 
</li><li> the numid used are specific to the author's card </li></ul>
<p>You will most likely need to change these variables. A note from the scripts author on how to get the numbers used by numid: 
<p><pre class="code">
You have to change the script for your card. 
 
numid=30 is the mixersource for my soundcard, 'ceset numdid=30 1 ' is to 
select the cd as capture source (0 = mic, 1 = cd, 4 = line)  
and numid=31 is the capture switch 
 
run "amixer controls" to get the numid's 
run "amixer cset numid=30" to get the capture source items (change 
numid=30 with yor capture source), I think you will take 4, the line in 
so 'amixer cset numid=30 4' to select line in as capture 
</pre> 
<p>See <a class="external" href="http://freevo.sourceforge.net/cgi-bin/moin.cgi/FrequentlyAskedQuestions#head-3fb8a33780b7fb2bef3edff84757d03e96461031"><img src="/wiki/img/moin-www.gif" width="11" border="0" alt="[WWW]" hspace="4" height="11">btaudio page</a> for using alsa with snd-bt87x module (the alsa btaudio equivalent) 
Not using OSS has the advantage for me that I can record from line-in with volume control muted, hence ENABLING timeshift recording. My record script, this is for a creative labs Soundblaster Live 5.1, using Alsa.  
<p><pre class="code">
#!/bin/bash  
  
# use with this VCR_CMD:  
# VCR_CMD = ('/usr/local/freevo_data/tvrecord/tvrecord %(channel)s %(seconds)s "%(filename)s"')  
  
CHAN=$1  
TIME=$2  
NAME=$3  
  
WIDTH=320  
HEIGHT=240  
  
MENCODER=/usr/local/bin/mencoder  
AMIXER=/usr/bin/amixer  
  
NICE="nice -n -20"  
  
AUDIO="-oac mp3lame -lameopts cbr:br=128:mode=3"  
VIDEO="-ovc lavc -lavcopts vcodec=mpeg4:vbitrate=1200:keyint=30"  
DSP="alsa:adevice=emu10k1"  
TV=" -tv driver=v4l:width=$WIDTH:height=$HEIGHT:outfmt=yuy2:input=0:device=/dev/video0:norm=PAL:chanlist=europe-west:channel=$CHAN:$DSP:forceaudio:forcechan=1:buffersize=64"  
  
$AMIXER -q sset Line 87% mute  
$AMIXER -q sset Capture 87%  
$AMIXER -q cset numid=63 4      # select capture source, 63 is capture source control, 1 = CD and 4 = line  
$AMIXER -q cset numid=64 1      # set capture source switch to 1 (= on)  
$NICE $MENCODER tv:// $TV $VIDEO $AUDIO -endpos $TIME -ffourcc divx -o  "$NAME.avi"  
$AMIXER -q sset Line 87% unmute   # unmute cd again to hear sound when using watching tv after recording  
</pre> 
<p><a name="head-f571bf41d3a98246d1b63980cb8389fcca4daf2a"></a><H1>4 IVTV setup</H1>

<p>In order to use the ivtv recording plugin have the following in your local_conf.py: 
<p><pre class="code">
plugin.remove('tv.generic_record') 
plugin_record = plugin.activate('tv.ivtv_record') 
</pre> 
<p>Also for ivtv_record you may set some recording options: 
<p><pre class="code">
IVTV_OPTIONS = { 
    'input'         : 4, 
    'resolution'    : '720x480', 
    'aspect'        : 2, 
    'audio_bitmask' : 233, 
    'bframes'       : 3, 
    'bitrate_mode'  : 1, 
    'bitrate'       : 4000000, 
    'bitrate_peak'  : 4000000, 
    'dnr_mode'      : 0, 
    'dnr_spatial'   : 0, 
    'dnr_temporal'  : 0, 
    'dnr_type'      : 0, 
    'framerate'     : 0, 
    'framespergop'  : 15, 
    'gop_closure'   : 1, 
    'pulldown'      : 0, 
    'stream_type'   : 10, 
} 
 
# Please see freevo_config.py for details. 
</pre> <a name="bottom"></a>
<hr><a href="http://www.python.org/"><img align="right" vspace="10"
src="/wiki/img/PythonPowered.gif" width="55" height="22" border="0"
alt="PythonPowered"></a>

<table border="0" cellspacing="0" cellpadding="0">
<form method="POST" action="/cgi-bin/moin.cgi/RecordingInfo">
<tr><td>
<input type="hidden" name="action" value="inlinesearch">
<input type="hidden" name="context" value="40">

<a href="/cgi-bin/moin.cgi/RecordingInfo?action=edit">EditText</a>
of this page
(last modified 2004-04-05 02:43:52)
<br>
<a href="/cgi-bin/moin.cgi/FindPage?value=RecordingInfo">FindPage</a>
 by browsing, title search <input style="font-family:Verdana; font-size:9pt;" type="text" name="text_title" value="" size="15" maxlength="50"><input type="image" src="/wiki/img/moin-search.gif" name="button_title"  alt="[?]" hspace="3" width="12" height="12" border="0">, text search <input style="font-family:Verdana; font-size:9pt;" type="text" name="text_full" value="" size="15" maxlength="50"><input type="image" src="/wiki/img/moin-search.gif" name="button_full"  alt="[?]" hspace="3" width="12" height="12" border="0"> or an index<br>
Or try one of these actions: 
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=AttachFile">AttachFile</a>, 
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=LikePages">LikePages</a>, 
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=LocalSiteMap">LocalSiteMap</a>, 
<a href="/cgi-bin/moin.cgi/RecordingInfo?action=SpellCheck">SpellCheck</a><br>

</td></tr>
</form>
</table>

<!-- MoinMoin 1.159 on sc8-pr-web6 served this page in 0.330 secs -->
</body></html>
